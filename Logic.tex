\documentclass[a4paper,oneside,11pt,DIV=12,parskip=half]{scrartcl}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{microtype}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{showlabels}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{enumerate}
\usepackage[usenames, dvipsnames]{color}
\usepackage{hyperref}

\title{Logic}
\author{ Luka Ili\'{c}}


\newcommand{\R}{\mathbb R}
\newcommand{\N}{\mathbb N}
\newcommand{\LL}{\mathcal L}
\newcommand{\J}{\mathcal J}
\newcommand{\A}{\mathcal A}

\newcommand{\pmat}[1]{\begin{pmatrix}
		#1
\end{pmatrix}}
\newcommand{\abs}[1]{\left| #1\right|}

\newcommand{\skal}[1]{\left \langle #1 \right\rangle}


\DeclareMathOperator{\grad}{grad}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem.}[section]
\newtheorem{lemma}[theorem]{Lemma.} 
\newtheorem{proposition}[theorem]{Proposition.}  
\newtheorem{corollary}[theorem]{Corollary.}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition.}
\newtheorem{remark, definition}[theorem]{Remark and Definition.}
\newtheorem{lemma, definition}[theorem]{Lemma and Definition.}  
\newtheorem{theorem, definition}[theorem]{Theorem and Definition.}  

\theoremstyle{remark}
\newtheorem*{remark}{\textbf{Remark}}
\newtheorem*{exercise}{\textbf{Exercise}}
\newtheorem*{example}{\textbf{Example}}
\newtheorem*{remark, example}{\textbf{Remark and Exercise}} 


\begin{document}

\maketitle

\pagebreak

\tableofcontents

\pagebreak

\section*{Preface}
The following notes, are to be regarded as such -- notes. They should contain most of what is written down in the logic lecture at Imperial College London (2018) by professor Evans. More likely then not, there will be a considerable amount of spelling errors (--please report everything to email down below or in Github comments--) that hopefully do not alter any important meaning. These notes will be constantly reread (by you the readers as well as myself) so I hope that at the end of the term most errors will be corrected so that anybody reading this will find good lecture notes for the exam.

\textbf{At the moment I still have problems with my labels so if you need to jump to a reference, just click on it}

\textbf{Anybody willing to help me, can write me an email at \\
\\ luka.ilic18@imperial.ac.uk} \\ \\ Help will only consist of being able to edit errors yourself. (So no need for any texing, except if you really want to.)

This is a project for my fellow students, so I hope it will be appreciated and used. I wish everybody reading this a lot of fun with the following content.

\pagebreak

\section{Propositional logic}

\subsection{Truth functions}
Convention: In this course we write $T$ for true and $F$ for false.

\begin{definition}
	The alphabet of propositional logic consists of following symbols:
 \emph{propositional variables} denoted (mostly) by $ p,q, \dots $ or 	$p_1,p_2,\dots, q_1, q_2, \dots$
	and the \emph{connectives} $\land, \lor, \lnot, \rightarrow, \leftrightarrow$.
\end{definition}

\begin{definition}\label{Def:formula}
	A \emph{propositional formula} is a string of symbols obtained in the following way:
\begin{enumerate}
\item Any variable is a formula.
\item If $\phi $ and $\psi$ are formulas then so are
$(\phi \land \psi),(\phi \lor \psi), (\lnot \phi), (\phi \rightarrow \psi), (\phi \leftrightarrow \psi)$.
\item Any formula is obtained in this way.
\end{enumerate}
\end{definition}

\begin{definition}
A \emph{truth function} of $n$ variables is a function 
	\[ f: \{ T,F \}^n \rightarrow \{ T,F \} \quad. \]
\end{definition}

\begin{exercise} 
How many functions are there for $n$ variables?

\end{exercise}

\begin{definition}
Suppose $\phi$ is a formula with variables $p_1, \dots, p_n$ then we obtain a truth function $F_{\phi}: \{T,F\}^n \rightarrow \{T,F\}$ whose value at $(x_1, \dots, x_n) \quad x_i \in \{T,F\} $ is the truth value of $\phi$ when $p_i$ has value $x_i$. The function $F_{\phi}$ is the \emph{truth function of $\phi$}.
\end{definition}

\begin{remark} The truth tables for the connectives are the following:
\begin{center}
\begin{tabular}{c|c}
     $p$ &  $\lnot p$  \\
     \hline
      $T$ & $F$ \\
      $F$ & $T$ \\
\end{tabular} \quad
\begin{tabular}{c|c|c}
     $p$ & $q$ & $p \land q$  \\
     \hline
     $T$ & $T$ & $T$ \\
     $T$ & $F$ & $F$ \\
     $F$ & $T$ & $F$ \\
     $F$ & $F$ & $F$ \\
\end{tabular} \\
\begin{tabular}{c|c|c}
     $p$ & $q$ & $p \lor q$  \\
     \hline
     $T$ & $T$ & $T$ \\
     $T$ & $F$ & $T$ \\
     $F$ & $T$ & $T$ \\
     $F$ & $F$ & $F$ \\
\end{tabular} \quad
\begin{tabular}{c|c|c}
     $p$ & $q$ & $p \rightarrow q$  \\
     \hline
     $T$ & $T$ & $T$ \\
     $T$ & $F$ & $F$ \\
     $F$ & $T$ & $T$ \\
     $F$ & $F$ & $T$ \\
\end{tabular} \quad
\begin{tabular}{c|c|c}
     $p$ & $q$ & $p \leftrightarrow q$  \\
     \hline
     $T$ & $T$ & $T$ \\
     $T$ & $F$ & $F$ \\
     $F$ & $T$ & $F$ \\
     $F$ & $F$ & $T$ \\
\end{tabular} .
\end{center}
\end{remark}

\begin{example}
What is the truth function of 
\[ (((p \rightarrow q) \land (q \rightarrow (\lnot p))) \rightarrow (\lnot p)) \quad ? \]

\end{example}

\begin{definition}
A propositional formula $\phi$ whose truth function $F_{\phi}$ is always true is called \emph{tautology}.
Say that formulas $\phi, \psi$ are \emph{logically equivalent} (l.e.) if they have the same truth function.
\end{definition}

\begin{remark}
$\phi,\psi$ are l.e. iff $(\phi \leftrightarrow \psi)$ is a tautology.
Also, suppose that we got some formula $\phi$ with variables $p_1, \dots, p_n$ and $\phi_1,\dots,\phi_n$ are formulas with variables $q_1, \dots, q_r$.
For each $i \leq n$ substitute $\phi$ in place of $p_i$ in $\phi$. Then the result is a formula $ \psi$ and if $\phi$ is a tautology, then so is $\psi$.
\end{remark}

\begin{proof}
The first statement is easy. For the second remark that
	\[ F_{\psi}(q_1, \dots, q_r) = F_{\phi}(F_{\phi_1}(q_1, \dots, q_r), \dots, F_{\phi_n}(q_1, \dots, q_r)) \]
by induction on the number of connectives in $\phi$.
\end{proof}

\begin{example}
\begin{enumerate}
\item $(p_1 \land ( p_2 \land p_3))$ is l.e. to $((p_1 \land p_2) \land p_3)$,
\item same with $ \lor $,
\item $(p_1 \lor (p_2 \land p_3))$ is l.e. to $((p_1 \lor p_2) \land (p_1 \lor p_3))$ 
\item similar the other way around.
\item etc.

\end{enumerate}
\end{example}

\begin{remark}
Note that by the remark above, we can boost these equivalences by substituting formulas for the variables.
\end{remark}

\begin{definition}

Say that a set of connectives is \emph{adequate} if for every $n \geq 1$, every truth function of $n$ variables is the truth function of some formula which involves only connectives from the set and variables $p_1, \dots, p_n$.
\end{definition}

\begin{theorem}\label{Th:connectives}
The set $\{ \lnot, \land, \lor\}$ is adequate. 
\end{theorem}

\begin{proof}
Let $G: \{T,F\}^n \rightarrow \{T,F\}$
\begin{enumerate}
\item $G(v) = F$ for all $v \in \{T,F\}$.
Take $\phi$ to be $(p_1 \land(\lnot p_1))$ then $ G = F_{\phi}$
\item (\emph{Disjunctive Normal Form}
List the $v \in \{ T,F \}^n$ with $G(v) = T$ as $v_1, \dots, v_r$.
Write $v_i = (v_{i1},\dots,v_{in})$
Define
\[ q_{ij} = \begin{cases} p_j &\text{if } v_{ij} = T \\  ( \lnot p_j) &\text{if } v_{ij} = F
\end{cases}\]
So $q_{ij}$ has value $T$ iff $p_j$ has value $v_{ij}$.
Let $\psi_i$ be
	\[ (q_{i1}, \dots, q_{in}), \]
then $F_{\psi_i}(v) = T$ iff each $q_{ij}$ has value $T$ iff $v = v_i$.

Let $\theta$ be $(\phi_1 \lor, \dots , \lor \phi_r)$.
Then $F_{\theta}(v) = T$ iff $F_{\psi_i}(v) = T$ for some $i$ which is equivalent to $v = v_i$ for some $i \leq r$.
Thus $F_{\theta} (v) = T$ iff $G(v) = T$ i.e. $F_{\theta} = G$.
As $\theta$ was constructed using only $\lnot,\lor,\land$ the statement follows.
\end{enumerate}

\end{proof}

\begin{definition}
A formula in the form as $\theta$ in the proof above (\ref{Th:connectives}) is said to be in \emph{disjunctive normal form (dnf)}.
\end{definition}

\begin{remark}

Apart from the very intuitive and useful dnf, having a small adequate set at our disposal is useful for the following reason. It shortens induction proofs over the structure of formulas by a considerable amount, as the reader will surely experience in due time.

\end{remark}

\begin{corollary} Suppose $\chi$ is a formula which truth function is not always false. Then $\chi$ is l.e. to a formula in dnf.
\end{corollary}

\begin{proof}
Take $G = F_{\chi}$ and apply the second case from the proof above.
\end{proof}
\begin{example} For
\[ \chi: \quad (( p_1 \rightarrow p_2) \rightarrow (\lnot p_2)) \] 
the truth function $F_{\chi}(v)$ is true precisely when $v = \{T,F\}$ or $ v = \{F, F \}$.
Hence the dnf is:
\[ ((p_1 \land (\lnot p_2)) \lor ((\lnot p_1) \land ( \lnot p_2))). \]

\end{example}

\begin{corollary}
The following sets of connectives are adequate:
\begin{enumerate}
    \item $\lnot, \lor$
    \item $\lnot, \land$
    \item $\lnot, \rightarrow$.
\end{enumerate}
\end{corollary}

\begin{proof}
\begin{enumerate}
    \item By \ref{Th:connectives} we just need to show, that $\land$ can be expressed using $\lnot,\lor$. $(p \land q)$ is l.e. to $(\lnot((\lnot p) \lor (\lnot q))$.
    \item similar to the approach above. $(p \lor q)$ is l.e. to $(\lnot((\lnot p) \land (\lnot q))$.
    \item Due to the cases above, it suffices to express either $\land$ or $\lor$ using $\lnot,\rightarrow$. $(p \lor q)$ is l.e. to $((\lnot p) \rightarrow  q)$.
\end{enumerate}
\end{proof}

\begin{example}

Some sets of connectives that are not adequate are:
\begin{enumerate}
    \item $\land, \lor$
    \item $\lnot,\leftrightarrow$
\end{enumerate}
\begin{proof}
\begin{enumerate}
    \item If $\phi$ is build using $\land,\lor$ then 
    $F_\phi(T,\dots,T) = T$ as proven by induction over number of connectives.
    \item exercise.
\end{enumerate}
\end{proof}
\end{example}

\begin{example}
The \emph{NOR} connective $\downarrow$ has truth table:
    \begin{tabular}{c|c|c}
        $p$ & $q$ & $(p \downarrow q)$ \\
        \hline
        $T$ & $T$ & $F$ \\ 
        $T$ & $F$ & $F$ \\
        $F$ & $T$ & $F$ \\
        $F$ & $F$ & $T$ \\
        
    \end{tabular}
    It is adequate on its own. (exercise - express $\lnot, \land$)
\end{example}

\subsection{A formal system for propositional logic}

Idea: Try to generate all tautologies from certain basic assumptions (axioms) using appropriate deduction rules.

\begin{definition}
\textbf{This is important!}

A \emph{formal deduction system} $\Sigma$ has the following ingredients:
\begin{enumerate}
    \item An \emph{alphabet} $A$ of symbols $(A \neq \emptyset)$.
    \item A non empty set $\mathcal{J}$ of the set of all finite sequences (`strings`) of the elements of A: the \emph{formulas} of $\Sigma$.
    \item A subset $\mathcal{A} \subseteq \mathcal{J}$ called the \emph{axioms} of $\Sigma$. 
    \item A collection of \emph{deduction rules}.
\end{enumerate}
\end{definition}

\begin{definition}
A \emph{proof} in $\Sigma$ us a finite sequence of formulas in $\mathcal{J}$ \[ \phi_1,\dots,\phi_n \] such that each $ \phi_i $ is either an axiom \emph{or} is obtained from $ \phi_1, \dots, \phi_{i-1} $ using one of the deduction rules. The last (or any) formula in a proof is a \emph{theorem} of $\Sigma$.
Write $\vdash_\Sigma \phi$ for `$\phi$ is a theorem of $\Sigma$`. 
\end{definition}

\begin{remark}
\begin{enumerate}
    \item If $\phi \in \mathcal{A}$ then $\vdash_\Sigma \phi$.
    \item We should have an algorithm to test whether a string of symbols really is a formula and whether it is an axiom. Then someone who is willing to follow an algorithm precisely (computer) should be able to generate all possible proofs in $\sigma$ and check whether something is a proof. (We say $\Sigma$ is \emph{recursive} in this case.)
\end{enumerate}
\end{remark}

\begin{definition}
The formal system $L$ for propositional logic consists of:

\begin{itemize}
    \item \textbf{Alphabet}: variables $p_1,p_2,p_3\dots$  connectives $\lnot,\rightarrow$
    punctuation ),(.
    \item \textbf{Formulas}: as defined in \ref{Def:formula} and will be called \emph{$L$-formulas}.
    \item \textbf{Axioms}: Suppose $\phi,\psi,\chi$ are $L$-formulas. The following are axioms of $L$:
    \begin{itemize}
        \item[A1] $(\phi \rightarrow (\psi \rightarrow \phi))$
        \item[A2] $((\phi \rightarrow (\psi \rightarrow \chi)) \rightarrow ((\phi \rightarrow \psi) \rightarrow (\phi \rightarrow \chi)))$
        \item[A3]: $(((\lnot \psi) \rightarrow ( \lnot \phi)) \rightarrow (\phi \rightarrow \psi))$
    \end{itemize}
    \item \textbf{deduction rule}: \emph{ Modus Ponens (MP)} from $\phi,  (\phi \rightarrow \psi)$ deduce $\psi$.
\end{itemize}

\begin{example} \label{rem:phi_implies_phi}

Suppose $\phi$ is an $L$-formula. Then $\vdash_L (\phi \rightarrow \phi)$.
A proof in $L$ could be as follows:
\begin{enumerate}
    \item $(\phi \rightarrow ((\phi \rightarrow \phi) \rightarrow \phi))$ use A1
    \item $(\chi \rightarrow (\phi \rightarrow ((\phi \rightarrow \phi) \rightarrow \phi)))$ use A1 and MP
    \item $((\phi \rightarrow (\phi \rightarrow \phi)) \rightarrow (\phi \rightarrow \phi))$
    \item $(\phi \rightarrow (\phi \rightarrow \phi))$
    \item $(\phi \rightarrow \phi)$.
\end{enumerate}
\end{example}
\end{definition}

\begin{definition}

Suppose $\Gamma$ is a set of $L$- formulas. A deduction from $\Gamma$ is a finite sequence of formulas of $L$-formulas $\phi_1,\dots,\phi_n$ such that each one of these $\phi_i$ is either
\begin{itemize}
    \item an axiom
    \item a formula in $\Gamma$ or
    \item is obtained from previous formulas $\phi_1,\dots,\phi_{i-1}$ using the deduction rule (MP).
\end{itemize}
Write $\Gamma \vdash_L \phi$ if there is a deduction from $\Gamma$ ending in $\phi$.

Say $\Gamma$ is a \emph{consequence} of $\Gamma$.
\end{definition}

\begin{remark}
Being a consequence of the empty set ($\Gamma = \emptyset$) is the same as being a theorem of $L$. ($\emptyset \vdash_L \phi \Leftrightarrow \vdash_L \phi$)
\end{remark}

\begin{theorem}[Deduction Theorem.]\label{Th:deductionL}
Suppose $\Gamma$ is a set of $L$-formulas and $\phi,\psi$ are $L$-formulas. Suppose
    \[ \Gamma \cup \{\phi\} \vdash \psi \] then
    \[ \Gamma \vdash_L (\phi \rightarrow \psi) \].
\end{theorem}

\begin{corollary}
Suppose $\phi,\psi,\chi$ are $L$-formulas such that $ \vdash_L (\phi \rightarrow \psi)$ and $ \vdash_L (\psi \rightarrow \chi)$. Then $ \vdash_L (\phi \rightarrow \chi)$
\end{corollary}

\begin{proof}
Use \ref{Th:deductionL} with $\Gamma = \emptyset$: Show $\{\phi\} \vdash_L \chi$. Here is a deduction of $chi$ from $phi$:
\begin{enumerate}
    \item $(\phi \rightarrow \psi)$ (theorem of $L$)
    \item $(\psi \rightarrow \chi)$ (theorem of $L$)
    \item $\phi$ (assumption)
    \item $\psi$ (MP)
    \item $\chi$ (MP).
\end{enumerate}
Thus $\{\phi\} \vdash_L \chi$.
By \ref{Th:deductionL}: $\emptyset \vdash_L (\phi \rightarrow \chi)$ i.e. $ \vdash_L (\phi \rightarrow \chi) $.
\end{proof}

\begin{lemma}
Suppose $\phi,\psi$ are $L$-formulas. Then
\begin{enumerate}
    \item $\vdash_L ((\lnot \psi) \rightarrow (\psi \rightarrow \phi))$.
    \item $\{(\lnot \psi),\psi\} \vdash_L \phi$.
    \item $\vdash_L (((\lnot \phi) \rightarrow \phi) \rightarrow \phi)$
\end{enumerate}
\end{lemma}

\begin{proof}
\begin{enumerate}
    \item problem sheet 1.
    \item by 1. and MP (twice)
    \item Suppose $\chi$ is any formula. Then $\{(\lnot \phi),((\lnot \phi) \rightarrow \phi) \} \vdash_L \chi$\label{frm:1} (by MP and 2.) 
    Let $\alpha$ be any axiom and let $\chi$ be $(\lnot \alpha)$.
    Apply \ref{Th:deductionL} to \ref{frm:1} to get:
    \[ \{((\lnot \phi) \rightarrow \phi)\} \vdash_L ((\lnot \phi) \rightarrow (\lnot \alpha)) \]
    A3: $(((\lnot \psi) \rightarrow ( \lnot \phi)) \rightarrow (\phi \rightarrow \psi))$ and MP generate:
    \[ \{((\lnot \phi) \rightarrow \phi)\} \vdash_L ( \alpha \rightarrow \phi) \quad. \]
    Since $\alpha$ is an axiom, by MP
        \[ \{((\lnot \phi) \rightarrow \phi)\} \vdash_L \phi \] and the application of \ref{Th:deductionL} gives us:
        \[ \vdash_L (((\lnot \phi) \rightarrow \phi) \rightarrow \phi) \quad. \]
\end{enumerate}

\end{proof}

\begin{proof}[Proof of \ref{Th:deductionL}:]
Suppose $\Gamma \cup \{\phi\} \vdash_L \psi$ using a deduction of length n. Show by induction on $n$ that $\Gamma \vdash_L (\phi \rightarrow \psi).$
\begin{itemize}
    \item[Base step:] $n = 1$. In this case $\phi$ is either an axiom or in $\Gamma$ or is $phi$. In the first two cases $\Gamma \vdash_L \phi$ (one line deduction!) Using the A1 axiom $(\psi \rightarrow (\phi \rightarrow \psi))$ and MP we obtain $\Gamma \vdash_L (\phi \rightarrow \psi)$.
    In the last case -- that $\phi = \psi$ -- we already know 
     \[ \Gamma \vdash (\phi \rightarrow \phi) \text{ by (\ref{rem:phi_implies_phi}.)} \]
    
     \item[induction step:] In our deduction of $\psi$ from $\Gamma \cup \{\phi\}$ either $\psi$ is an axiom or $\psi$ is obtained from earlier steps using MP. In the last case these are formulas $\chi, (\chi \rightarrow \psi)$ earlier in the deduction.
     in the first case we argue as in the base case to get $\Gamma \vdash_L (\phi \rightarrow \psi)$.
     Otherwise we use the inductive hypothesis to get $$\Gamma \vdash_L (\phi \rightarrow \chi)$$ and 
        \[ \Gamma \vdash_L (\phi \rightarrow (\chi \rightarrow \psi)). \]
    We have the A2 axiom 
        \[ ((\phi \rightarrow (\psi \rightarrow \chi)) \rightarrow ((\phi \rightarrow \psi) \rightarrow (\phi \rightarrow \chi))) \]
    Using the two formulas we obtained, this axiom and MP twice we obtain $\Gamma \vdash_L (\phi \rightarrow \psi)$ as required, completing the induction step.
\end{itemize}
\end{proof}

\subsection{soundness and completeness of L}

\begin{theorem}[soundness of L] \label{Th:soundnessL}
Suppose $\phi$ is a theorem of $L$. Then $\phi$ is a tautology.
\end{theorem}
\begin{remark}[notation]
 A (propositional) \emph{valuation} $v$ is an assignment of truth values to the propositional variables $p_1,p_2,\dots$ .
 So $v(p_i) \in \{ T, F \}$ (for $i \in \N)$.
 Note that, using the truth table rules, this assigns a truth value $v(\phi) \in \{ T, F \}$ to every $L$-formula $\phi$.
\end{remark}

\begin{proof}[Proof of \ref{Th:soundnessL}:] By the induction on the length of a proof of $\phi$ it is enough to show:
\begin{enumerate}
    \item every axiom is a tautology;
    \item MP preserves tautologies. I.e. if $\psi,(\psi \rightarrow \chi)$ are tautologies, then so is $\chi$.
\end{enumerate}
For 1. use truth tables or argue as follows:
\begin{itemize}
    \item [A2] Suppose for 1. if there is a valuation $v$ with \[ v(((\phi \rightarrow (\psi \rightarrow \chi)) \rightarrow ((\phi \rightarrow \psi) \rightarrow (\phi \rightarrow \chi)))) = F \]
    Then \[ v((\phi \rightarrow (\psi \rightarrow \chi))) = T \] and 
        \[ v(((\phi \rightarrow \psi) \rightarrow (\psi \rightarrow \chi))) = F \]
    
    $v((\phi \rightarrow \psi) = T$ and $v((\phi \rightarrow \chi)) = F$
    So by the last equality $v(\phi) = T, v(\chi) = F$ and also $(\psi) = T$ which contradicts the first equation.
    \item[A1] exercise
    \item[A3] exercise
\end{itemize}
For 2. if $v$ is a valuation and $v(\psi) = T + v(\psi \rightarrow \chi) = T$ then $v(\chi) = T$.

\end{proof}

\begin{theorem}[Generalization of soundness]

Suppose $\Gamma$ is a set of formulas and $\phi$ is a formula with $\Gamma \vdash_L \phi$. Suppose $v$ is a valuation with $v(\phi) = T$ for all $\phi \in \Gamma$. Then $v(\phi) = T$.
\end{theorem}
\begin{proof}
exercise
\end{proof}

\begin{theorem}[Completeness Theorem for L.]
Suppose $\phi$ is a tautology. Then $\vdash_L \phi$.

\end{theorem}

\begin{remark}[steps in the proof]
\begin{enumerate}
    \item 
 If $v(\phi) = T$ for all valuations $v$ -- we want to show $\vdash_L \phi$.
    \item Try to prove a generalization: Suppose that for every $v$ with $v(\Gamma) = T$ (i.e. $v(\phi) = T \forall \phi \in \Gamma$) we have $v(\phi) = T$. Then $\Gamma \vdash_L \phi$.
    \item Equivalently, if $\Gamma \not \vdash_L \phi$ show there is a valuation $v$ with $v(\Gamma) = T$ and $v(\phi) = F$.
\end{enumerate}
\end{remark}

\begin{definition}
A set $\Gamma$ of $L$- formulas is \emph{consistent} if there is no $L$-formula $\phi$ with
    \[\Gamma \vdash_L \phi \text{ and } \Gamma \vdash_L (\lnot \phi) \quad . \]
\end{definition}

\begin{proposition}\label{TH:extension}
Suppose $\Gamma$ is a consistent set of $L$-formulas and $\Gamma \not \vdash_L \phi$. Then $\Gamma \cup \{(\lnot \phi)\}$ is consistent.
\end{proposition}
\begin{proof}
Suppose not. So there is some formula $\psi$ with
\[ \Gamma \cup \{(\lnot \phi) \} \vdash_L \psi \] and
\[ \Gamma \cup \{(\lnot \phi) \} \vdash_L (\lnot \psi) \]
Apply \ref{Th:deductionL} to the second line above, then
\[ \Gamma \vdash_L ((\lnot \phi) \rightarrow (\lnot \psi)). \]
By A3 and MP we obtain
\[ \Gamma \vdash_L (\psi \rightarrow \psi). \]
Then $\Gamma \cup \{(\lnot \phi) \} \vdash_L \phi$. By \ref{Th:deductionL}: 
\[ \Gamma \vdash_L ((\lnot \phi) \rightarrow (\lnot \phi)  \]
and by a result from above
    \[ \vdash_L (((\lnot \phi) \rightarrow \phi) \rightarrow \phi) \]
So by this, $ \Gamma \vdash_L ((\lnot \phi) \rightarrow (\lnot \phi)$   and Modus Ponens we obtain
\[ \Gamma \vdash_L \phi. \]
This contradicts $\Gamma \not \vdash_L \phi$.
\end{proof}

\begin{proposition}[Lindenbaum Lemma]
Suppose $\Gamma$ is a consistent set of $L$-formulas. Then there is a consistent set of formulas
$ \Gamma^* \supseteq \Gamma$ such that for every $\phi$ either
    \[\Gamma^* \vdash_L \phi \] or
    \[\Gamma^* \vdash_L (\lnot \phi) \quad . \]
    (sometimes say $\Gamma^*$ is \emph{complete}.) 
\end{proposition}

\begin{proof}
The set of all $L$-formulas is \emph{countable}, so we can list the $L$-formulas as $\phi_0,\phi_1,\dots$.
(Why countable? Alphabet is countable: $\lnot, \rightarrow,),(,p_1,p_2,\dots$. Formulas are finite sequences from this alphabet, hence only countably many.)
Define inductively sets of $L$-formulas $\Gamma_0 \subseteq \Gamma_1 \subseteq \Gamma_2\subseteq \dots$, where 
\[ \Gamma_0 = \Gamma\] and \[\Gamma^* = \bigcup_{i \in \N} \Gamma_i \quad .\] Suppose $\Gamma_n$ has been defined. If $\Gamma_n \vdash_L \phi_n$ then let $\Gamma_{n+1} := \Gamma_n$.
Otherwise, if $\Gamma_n \not \vdash_L \phi_n$ then let $\Gamma_{n+1} := \Gamma_n \cup \{(\lnot \phi_n)\}$. An easy induction using \ref{TH:extension} shows that each $\Gamma_i$ is consistent.
\\
\textbf{Claim:}: $\Gamma^*$ is consistent.
If $\Gamma^* \vdash_L \phi$ and $\Gamma^* \vdash_L (\lnot \phi)$ then as deductions are finite sequences of $L$ -formulas \[ \Gamma_n \vdash_L \phi \text{ and } \Gamma_n \vdash_L (\lnot \phi) \] for some $n \in \N$: contradiction.
Now to show that $\Gamma^*$ is complete, let $\phi$ be any formula. So $\phi = \phi_n$ for some $n \in \N$. If $\Gamma^* \not \vdash_L \phi$ then $\Gamma_n \not \vdash_L \phi$. So by construction $\Gamma_{n+1} \vdash_L (\lnot \phi)$. Therefore $\Gamma^* \vdash_L (\lnot \phi)$ and since $\phi$ was arbitrary this proves the statement.
\end{proof}

\begin{lemma} \label{LM:valuation}
Let $\Gamma^*$ be as above, then there is a valuation $v$ such that for every $L$-formula $\phi$
    \[ v(\phi) = T \Leftrightarrow \Gamma^* \vdash_L \phi \]
\end{lemma}

\begin{corollary}
 Suppose $\Delta$ is a set of $L$-formulas which is consistent and 
    \[\Delta \not \vdash_L \phi \quad . \]
    Then there is a valuation $v$ with 
        \[ v(\Delta) = T \text{ and } v(\phi) = F \quad. \]
\end{corollary}

\begin{proof}
 Let $\Gamma:= \Delta \cup \{ (\lnot \phi) \}$. By \ref{TH:extension}, $\Gamma$ is consistent. By the Lindenbaum lemma there is $\Gamma^*  \supseteq \Gamma$ which is consistent and such that for every $\chi$ either $\Gamma^* \vdash_L \chi \text{ or } \Gamma^* \vdash_L \lnot \chi$. By \ref{LM:valuation} there exists a valuation with $v(\Gamma^*) = T$. In particular $v(\Delta) = T$ and $v((\lnot \phi)) = T$ thus $v(\phi) = F$.
\end{proof}

\begin{theorem}[completeness/Adequacy theorem for $L$]\label{Th:completenessL}
If $v(\phi) = T$ for every valuation $v$, then $\vdash_L \phi$.
\end{theorem}

\begin{proof}
 Suppose $\not \vdash_L \phi $. then apply the corollary above with $\Delta = \emptyset$. (Why is this consistent? Soundness Theorem.) There is a valuation with $v(\phi) = F$.
\end{proof}

\begin{proof}[Proof of \ref{LM:valuation}.]
 $\Gamma^*$ consistent set of $L$-formulas such that for every $L$-formula $\phi$ either $\Gamma^* \vdash_L \phi$ or $\Gamma^* \vdash_L \lnot \phi$. Want valuation $v$ with $v(\phi)= T$ for all $\phi \in \Gamma^*$. (i.e. $v(\phi) = T \Leftrightarrow \Gamma^* \vdash_L \phi$.)
 Note that for each variable $p_i$ either $\Gamma^* \vdash_l p_i$ or $\Gamma^* \vdash_L (\lnot p_i)$. So let $v$ be the valuation with $v(p_i) = T \Leftrightarrow \Gamma^* \vdash_L p_i$.
 Now, prove by induction on the length of $\phi$ that $v(\phi) = T \Leftrightarrow \Gamma^* \vdash_L \phi$.
 
 \begin{itemize}
     \item[Base case:] $\phi$ is just a propositional variable -- this case holds by the definition of $v$.
     \item[inductive step:]
     \textbf{Case 1:} $\phi$ is $(\lnot \psi)$.
     "$\Rightarrow$": $v(\phi) = T$ then $v(\psi) = F$ and by the induction hypothesis $\Gamma^* \not \vdash_L \psi$. Then by the completeness of $\Gamma^*$, $\Gamma^* \vdash_L (\lnot \psi)$ i.e. $\Gamma^* \vdash_L \phi$.
     "$\Leftarrow$": Suppose $\Gamma^* \vdash_L \phi$. By consistency $\Gamma^* \not \vdash_L \psi $. By the induction hypothesis $v(\psi) = F$. As $v$ is a valuation we obtain $v(\phi) = T$ which concludes the first case. \\
     \textbf{Case 2:} $\phi$ is $(\psi \rightarrow \chi)$.
     "$\Rightarrow$": Suppose $v(\phi) = F$. Then $v(psi) = T$ and $v(\chi) = F$. By the induction hypothesis $\Gamma^* \vdash_L \psi$ and $\Gamma^* \not \vdash_L \chi$. If
        \[ \Gamma^* \vdash_L \phi \] then using modus ponens and$\Gamma^* \vdash \psi$ we obtain 
        \[\Gamma^* \vdash_L \chi\] which is a contradiction. So $\Gamma^* \not \vdash_L \phi$.
    "$\Leftarrow$": Suppose $\Gamma^* \not \vdash_L (\psi \rightarrow \chi) $. Then $\Gamma^* \not \vdash \chi$ (due to A1).
    Also, due to a result from above, $\Gamma^* \not \vdash_L (\lnot \psi)$. By combining these results we obtain $v(\chi) = F$ and $v(\psi) = T$ therefore $v(\phi) = F$ which concludes the induction step.
 \end{itemize}
\end{proof}

\begin{corollary}
 Suppose $\Delta$ is a set of $L$-formulas and $\phi$ is an $L$-formula. Then
 \begin{enumerate}
     \item $\Delta$ is consistent if and only if there is a valuation $v$ with $v(\Delta) =T$.
     \item $\Delta \vdash_L \phi$ if and only if for every valuation $v$ with $v(\Delta) = T$
 \end{enumerate} we have $v(\phi) = T$.
\end{corollary}
\begin{proof}
 Exercise -- deduce these from the preliminaries to \ref{Th:completenessL}. Warning: in the second statement $\Delta$ is not necessarily consistent.
\end{proof}

\begin{theorem}[Compactness Theorem for L]
Suppose $\Delta$ is a set of $L$-formulas. The following are equivalent:
\begin{enumerate}
    \item There is a valuation $v$ with $v(\Delta) = T$.
    \item For every finite subset $\Delta_0 \subseteq \Delta$ there us a valuation $w$ with $w(\Delta_0) = T$.
\end{enumerate}
\end{theorem}

\begin{proof}
By the above corollary, the first is true iff $\Delta$ is consistent.
Similarly the second holds iff every finite subset is consistent.
But if $\Delta \vdash_L \phi$ and $\Delta \vdash_L (\lnot \phi)$ then as deductions are finite (+ therefore only involves finitely many $L$-formulas in $\Delta$), for some finite $\Delta_0 \subseteq \Delta$, $\Delta_0 \vdash_L \phi$ and $\Delta_0 \vdash_L (\lnot \phi)$.
\end{proof}

\begin{exercise}
Let $P$ be the set of sequences of 
\end{exercise}

\section{Predicate Logic}
also called first-order logic
Plan :
\begin{enumerate}
    \item introduce mathematical objects that this logic can reason about. I.e. \emph{First-order structures}
    \item introduce the formulas. I.e. \emph{First order languages}
    \item describe  formal system
    \item show that the theorems of the formal system are exactly the formulas true in all structures. (Goedel Completeness Theorem
\end{enumerate}

\subsection{Structures}

\begin{definition}
    Suppose $A$ is a set and $n \in \N$, An \emph{$n$-ary relation} of $A$ is a subset $\overline{R} \subseteq A^n$.
    An \emph{$n$-ary function} on $A$ is a function $\overline{f}: A^n \rightarrow A$.
\end{definition}

\begin{example}
\begin{enumerate}
    \item ordering $\leq$ on $\N$ is $2$-ary relation on $\N$.
    \item addition, multiplication are $2$-ary functions on their respective sets.
    \item a $1$-ary relation is just a subset. (even numbers in $\N$, etc.)
\end{enumerate}

\textbf{Notation:} If $R \subseteq A^n$ is an $n$-ary relation, then we write $R(a_1,\dots,a_n)$ for $(a_1,\dots,a_n) \in R$.

\begin{definition}
    A \emph{first-order structure} $\mathcal{A}$ consists of:
    \begin{enumerate}
        \item A nonempty set A -- the \emph{domain} of $\mathcal{A}$
        \item A set $\{\overline{R}_i:i \in I \}$ of \emph{relations} on $A$.
        \item A set $\{\overline{f}_j:j \in J \}$ of \emph{functions} on $A$.
        \item A set $\{\overline{c}_k:k \in K \}$ of \emph{constants} in $A$. ($c_k \in A$)
    \end{enumerate}
\end{definition}
\begin{remark}
The sets $I,J,K$ can be empty and are indexing sets (usually subsets of $N$).
The information 
\[ (n_i : i \in I), (m_j : j \in J), K \] is called the \emph{signature} of $\mathcal{A}$.
Might denote the structure by
\[ \mathcal{A}=\langle A; (\overline{R}_i : i \in I), (\overline{f}_j : j \in J), (\overline{c}_k : k \in K) \rangle \]
\end{remark}
\end{example}

\begin{example}
\begin{enumerate}
    \item \emph{Orderings}
    $A = \N, \mathbb{Q}, \R $ and $I = \{1\},J=K=\emptyset$, $n_i = 2$. and $\overline{R}_1(a,b)$ means $a\leq b$.
    \item \emph{Groups}
    The domain is just the underlying set of the group and we take the signature: $\overline{R},\overline{m},\overline{i},\overline{e}$, where the first is the $2$-ary relation of equality, then multiplication, inversion and the neutral element.
    \item \emph{Rings}
    The domain is just the underlying set of the group and we take the signature: $\overline{R},\overline{m},\overline{a},\overline{i},\overline{0},\overline{1}$, where the first is the $2$-ary relation of equality, then multiplication, addition, subtraction and the neutral elements for addition and multiplication.
    \item \emph{Graphs}
    $A = V$ a set of vertices, a binary relation $\overline{E} \subseteq A^2$ the set of vertices (connected elements) and again the binary relation $\overline{R}$ for equality.
\end{enumerate}
\end{example}

\subsection{First-order languages}
\begin{definition}
    A \emph{first-order-language} $\mathcal{L}$ has an alphabet of symbols of the following types:
    \begin{enumerate}
        \item \emph{variables}: $x_0,x_1,x_2,\dots$
        \item \emph{punctuation}: $),(,\quad ,$ (the comma is a symbol as well)
        \item \emph{connectives}: $\lnot, \rightarrow$
        \item \emph{quantifier}: $\forall$
        \item \emph{relation symbols}: $R_i$ $i \in I$
        \item \emph{function symbols}: $f_j$ $j \in J$
        \item \emph{constant symbols}: $c_k$ $k \in K$
    \end{enumerate}
    Here $I,J,K$ are indexing sets (can once again be empty). Each $R_i$ comes equipped with an \emph{arity} $n_i$; each $f_j$ comes equipped with an arity $m_j$.
    The information 
    \[ (n_i : i \in I), (m_j : j \in J), K \] is called the \emph{signature} of $\mathcal{L}$.
    A first order structure $\mathcal{A}$ with the same signature as $\mathcal{L}$  is referred to as an \emph{$\mathcal{L}$-structure}.
\end{definition}

\begin{definition}
    A \emph{term} of $\mathcal{L}$ is defined as follows:
    \begin{enumerate}
        \item any variable is a term
        \item any constant symbol is a term
        \item if $f$ is an $n$-ary function symbol of $\mathcal{L}$ and $t_1,\dots,t_n$ are terms, then
        \[ f(t_1,\dots,t_n) \] is a term.
        \item any term arises in this way.
    \end{enumerate}
\end{definition}

\begin{definition}
\begin{enumerate}
    \item An \emph{atomic formula} of $\LL$ is of the form $ R(t_1,\dots,t_n) $, where $R$ is a $n$-ary relation symbol of $\LL$ and $t_1,\dots,t_n$ are terms.
    \item the \emph{formulas} of $\LL$ are defined as follows:
    \begin{enumerate}
        \item any atomic formula is a formula
        \item if $\phi,\psi$ are $\LL$ formulas, then 
        \[ (\lnot \phi), (\phi \rightarrow \psi), (\forall x) \phi \]
        are $\LL$-formulas, where $x$ is any variable.
        \item every formula arises this way.
    \end{enumerate}
\end{enumerate}
\end{definition}
\begin{example}
Suppose $\LL$ has 
\begin{itemize}
    \item $2$-ary function symbol $f$,
    \item $1$-ary relation symbol $P$,
    \item $2$-ary relation symbol $R$,
    \item constants $c_1,c_2,\dots$
\end{itemize}
Some terms: 
\[ x,c,f(x_1,c_1) ,f(f(x_1,c_1),x_2), \dots \]
Some atomic formulas:
\[ P(x_1),R(f(x_1,c_1),c_2), etc. \]
Some formulas:
$\dots$
\end{example}


\begin{definition}
Suppose $\phi,\psi$ are $\LL$-formulas, then
\[ (\exists x) \phi \text{ means } (\lnot (\forall x) (\lnot \phi) \]
and the other shorthands as in the propositional logic.
\end{definition}

\begin{definition}
Suppose $\LL$ is a first-order language with relation,function and constant symbols
\begin{itemize}
    \item $R_i$ (of arity $n_i$) for $i \in I$
    \item $R_i$ (of arity $m_j$) for $j \in J$
    \item $c_k$ for $k \in K$.
\end{itemize}
An \emph{$\LL$-structure} is a structure 
\[ \mathcal{A} = \big \langle A, (\overline{R}_i : i\in I), (\overline{f}_j : j\in J), (\overline{c}_k : k\in K) \big \rangle \] of the same signature as $\LL$.
There is a correspondence between the relation, function and constant symbols and the actual relations, functions and constants in $\mathcal{A}$. THis correspondence, or $\mathcal{A}$ itself, is called an \emph{interpretation} of $\LL$.
\end{definition}

\begin{definition}
With the same notation as above, suppose $\mathcal{A}$ is an $\LL$-structure. A \emph{valuation in $$\mathcal{A}$$} is a function $v$ from the set of terms on $\LL$ to A satisfying:
\begin{itemize}
    \item[a)] $v(c_k) = \overline{c}$
    \item[b)] if $t_1,\dots, t_m$ are terms of $\LL$ and $f$ is an $m$-ary function symbol, then $v(f(t_1,\dots,t_m)) = \overline{f}(v(t_1),\dots,v(t_m))$ where $\overline{f}$ is the interpretation of $f$ in $\mathcal{A}$.
\end{itemize}
\end{definition}

\begin{lemma}
Suppose $\mathcal{A}$ is an $\LL$-structure and $a_0,a_1,\dots \in A$. Then there is a unique valuation $v$ in $\mathcal{A}$ with $v(x_l) =a_l$ for all $l \in \N$.
($x_0,x_1,\dots$ are the variables of $\LL$)
\end{lemma}

\begin{proof}
By induction on the length of terms: show that if we let
\begin{enumerate}
    \item $v(x_l) = a_l$ for all $l \in \N$.
    \item $v(c_k) = \overline{c}_k$ for all $k \in K$.
    \item $v(f(t_1,\dots,t_m) = \overline{f}(v(t_1),\dots,v(t_m))$
\end{enumerate}
then $v$ is a well-defined valuation. (rest exercise).
\end{proof}

\begin{example}
Groups:  The domain is just the underlying set of the group and we take the signature: $\overline{R},\overline{m},\overline{i},\overline{e}$, where the first is the $2$-ary relation of equality, then multiplication, inversion and the neutral element.
Let $\mathcal{G}$ be a group and $g,h \in \mathcal{G}$. Let $v$ be a valuation with $ v(x_0) = g, v(x_1)=h$. Then 
\[ v(m(m(x_0,x_1),i(x_0))) = \overline{m}(v(m(x_0,x_1)),v(i(x_0)) = \dots = ghg^{-1} \]
\end{example}

\begin{definition}
 Suppose $\mathcal{A}$ is an $\LL$ structure and $x_l$ is any variable. Suppose $v,w$ are valuations in $\mathcal{A}$. We say that $v,w$ are \emph{$x_l$-equivalent} if $v(x_m) = w(x_m)$ whenever $m \neq l$.
\end{definition}

\begin{definition}
 Suppose $\mathcal{A}$ is an $\LL$-structure and $v$ is a valuation in $\mathcal{A}$.
 Define, for an $\LL$-formula $\phi$, what is meant by \\
\emph{$v$ satisfies $\phi$ in $\mathcal{A}$},
\begin{enumerate}
    \item \underline{atomic formulas}
    Suppose $R$ is an $n$-ary relation symbol and $t_1,\dots,t_n$ are terms of $\LL$. Then $v$ satisfies the atomic formula $R(t_1,\dots,t_n)$ if and only if $\overline{R}(v(t_1),\dots,v(t_n))$ holds in $\mathcal{A}$.
    \item \underline{$\LL$-formulas}
    Suppose that $\phi,\psi$ are $\LL$ formulas and we already know about valuations satisfying $\phi,\psi$. Then
    \begin{itemize}
        \item $v$ satisfies $(\lnot \phi) $ iff $v$ does not satisfy $\phi$ in $\mathcal{A}$.
        \item $v$ satisfies $(\phi \rightarrow \psi)$ in $\mathcal{A}$ iff it is not the case that $v$ satisfies $\phi$ and $v$ does not satisfy $\psi$.
        \item $v$ satisfies $(\forall x_l ) \phi $ iff every valuation $w$, that is $x_l$-equivalent to $v$ satisfies $\phi$.
    \end{itemize}
\end{enumerate}
\end{definition}

\begin{remark}
The definition above does not work, if the structure is empty. (So we will not allow it).

If $v$ satisfies $\phi$, write $v[\phi] = T$. Otherwise write $v[\phi]=F$.

If every valuation in $\A$ satisfies $\phi$ then we say that $\phi$ is \emph{true} in $\A$, or $\A$ is \emph{a model of} $\phi$ ($\A \vDash \phi$).

If $\A \vDash \phi$ for every $\LL$-structure $\A$, we say that $\phi$ is \emph{logically valid} and write $\vDash \phi$.
-- These are analogues of tautologies in the propositional logic. Difference: In propositional logic there is an algorithm to decide whether a given formula is a tautology. There is \emph{no} such algorithm to decide whether a given $\LL$-formula is logically valid or not. -- Consequence of the Goedel Incompleteness Theorem.
\end{remark}

\begin{example}
\begin{enumerate}
    \item Suppose $\LL$ has a binary relation symbol $R$. The $\LL$-formula 
            \[ R(x_1,x_2) \rightarrow (R(x_2,x_3) \rightarrow R(x_1,x_3))) \]
        is true in $\A = \langle \N; < \rangle $, where $ < $ is the interpretation of $R$.
        If the formula is not true, then there is a valuation $v$ such that $v$ satisfies $R(x_1,x_2)$ and $v$ does not satisfy $R(x_2,x_3) \rightarrow R(x_1,x_3)$. So $v[R(x_2,x_3) = T$ and $v[R(x_1,x_3)]=F$. Let $v(x_i) = a_i \quad \in \N$. So 
            \[ a_1 < a_2 \quad a_2 \ a_3 \quad a_1 \not < a_3 \] 
        which is impossible since $<$ is transitive on $\N$.
    \item The same formula is not true in the structure $\mathcal{B}$ with domain     $\N$ where we interpret $R(x_i,x_j)$ as $x_i \neq x_j$. Take a valuation      in $\mathcal{B}$ with $v(x_1) = 1 = v(x_3)$ and $v(x_2) = 2$.
    \item Lemma: Suppose $\A$ is an $\LL$-structure and $\phi$ an $\LL$-formula. Let $v$ be a valuation in $\A$, then:
        $v$ satisfies $(\exists x_1) \phi $ (in $\A$) if and only if there is a valuation $w$ which is $x_1$ equivalent to $v$ such that $w$ satisfies $\phi$.
        \begin{proof}
        "$\Rightarrow$" Suppose $v$ satisfies $(\lnot ( \forall x_1) (\lnot \phi))$. Hence $v$ does not satisfy $(\forall x_1) (\lnot \phi)$. So there is a valuation $w$ $x_1$-equivalent to $v$ such that $w$ does not satisfy $(\lnot \phi)$. Such a $w$ satisfies $w$.
        "$\Leftarrow$" exercise.
        \end{proof}
\end{enumerate}
\end{example}

\begin{example}
    $(\forall x_1)(\exists x_2) R(x_1,x_2)$ is true in $\skal{\mathbb{Z},<}$ and $\skal{\N,<}$ but not in $\skal{\N,>}$.
\end{example}

\begin{exercise}
    Suppose $\phi$ is any $\LL$-formula. Then
    \begin{itemize}
        \item $(\exists x_1)(\forall x_2) \phi \rightarrow (\forall x_2)(\exists x_1)\phi) $ is logically valid.
        \item $((\forall x_2)(\exists x_1) \phi \rightarrow (\exists x_1)(\forall x_2)\phi)$ is not necessarily logically valid.
    \end{itemize}
    the first can be shown with valuation arguments. The second can be shown by giving an example.
\end{exercise}

\begin{example}[Some logically valid formulas]
Consider the propositional formula 
    \[ \chi \quad (p_1 \rightarrow (p_2 \rightarrow p_1)) \]
    Suppose $\LL$ is a first order language and $\phi_1, \phi_2$ are $\LL$-formulas. Substitute $\phi_1$ in place of $p_1$ and $\phi_2$ in place of $p_2$ in $\chi$. We obtain an $\LL$-formula 
    \[ \theta \quad (\phi_1 \rightarrow (\phi_2 \rightarrow \phi_1)) \]
    One can check that $\theta$ is logically valid.
    
\end{example}

\begin{definition}
 Suppose $\chi$ is an $\LL$-formula involving propositional variables $p_1,\dots ,p_n$. Suppose $\LL$ is a first order language and $\phi_1,\dots,\phi_n$ are $\LL$-formulas. A \emph{substitution instance} of $\chi$ is obtained by replacing each $p_i$ by $\phi_i$. Call the result $\theta$.   
\end{definition}

\begin{theorem}
\begin{enumerate}
    \item $\theta$ is an $\LL$-formula.
    \item If $\chi$ is a tautology, then $\theta$ is logically valid.
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}
    \item is clear by the definition of a formula.
    \item Take an $\LL$-structure $\A$ and a valuation $v$ in $\A$. Use this to define a propositional valuation $w$ with
        \[ w(p_i) = v[\phi_i] \quad i \leq n. \]
    Then prove by induction on the number of connectives in $\chi$ that the value
        \[ w(\chi) = v[\theta] \]
    In particular if $\chi$ is a tautology then $v[\theta] = T$. (E.g. in the inductive step you consider the case where $\chi$ is $(\alpha \rightarrow \beta)$. SO $\theta$ is $(\theta_1 \rightarrow \theta_2)$ where $\theta_1$ is obtained from $\alpha$ etc.
    By the induction hypothesis
        \[ w(\alpha) = v[\theta_1] \text{ and } w(\beta) = v[\theta_2] \]
    Thus $ w(\alpha \rightarrow \beta) = v[\theta_1 \rightarrow \theta_2].$ The other connectives and details are left as exercise.
\end{enumerate}
\end{proof}

\begin{remark}
Not all logically formulas arise in this way.
E.g. $(\exists x_1)(\forall x_2) \phi \rightarrow (\forall x_2)(\exists x_1)\phi) $
\end{remark}
\subsection{Bound and free variables in formulas}

\begin{example}
\[ (R_1(x_1,x_2) \rightarrow (\forall x_3)R_2(x_1,x_3)) \]
\end{example}

\begin{definition}
 Suppose $\phi,\psi$ are $\LL$- formulas and $(\forall x_i)\phi$ occurs as a subformula of $\psi$, i.e. $\psi$ is $\dots  (\forall x_i)\phi \dots$.
 We say that $\phi$ is the \emph{scope} of the quantifier $(\forall x_i)$ in $\psi$. An occurrence of a variable $x_j$ in $\psi$ is \emph{bound} if it is in the scope of a quantifier $(\forall x_j)$ in $\psi$ (or if it is simply written after a quantifier).
 Otherwise it is a \emph{free} occurrence (of $x_j$). Variables having a free occurrence in $\psi$ are called the \emph{free variables} of $\psi$.
 A formula with no free variables is called a \emph{closed formula} or a \emph{sentence} (of $\LL$).
\end{definition}

\begin{example}
\begin{enumerate}
    \item $\psi_2: \quad ((\forall x_1)R_1(x_1,x_2) \rightarrow R_2(x_1,x_2))$
    $x_1$ is free since $R_1(x_1,x_2)$ is the scope for $(\forall x_1)$ but it is occurring freely in $R_2(x_1,x_2))$.
    Compare with 
    $ \quad ((\forall x_1)(R_1(x_1,x_2) \rightarrow R_2(x_1,x_2)))$. Now $x_1$ is bound.
    
    \item $\psi_3: \quad ((\exists x_1)R_1(x_1,x_2) \rightarrow (\forall(x_2)R_2(x_2,x_3))$.
    Here, $x_1$ is bound but $x_2,x_3$ are free.
\end{enumerate}
\end{example}

\begin{remark}[notation]
If $\psi$ is an $\LL$-formula with free variables amongst $x_1,\dots,x_n$, we might write $\psi(x_1,\dots,x_n)$.
If $t_1,\dots,t_n$ are terms, by $\psi(t_1,\dots,t_n)$ we mean the $\LL$-formula obtained by replacing each \emph{free} occurrence of $x_i$ by $t_i$.

E.g.
\[ \psi(x_1,x_2): \quad ((\forall x_1)R_1(x_1,x_2) \rightarrow (\forall x_3) R_2(x_1,x_2,x_3)) \]
\[t_1: \quad f_1(x_1) \text{ and } t_2: \quad f_2(x_1,x_2) \]
So 
\[ \psi(t_1,t_2): \quad ((\forall x_1)R_1(x_1,t_2) \rightarrow (\forall x_3) R_2(t_1,t_2,x_3)) \]
\end{remark}

\begin{theorem}
Suppose $\phi$ is a closed $\LL$-formula and $\A$ is an $\LL$-structure, then either $$\A \vDash \phi \text{ or } \A \vDash (\lnot \phi).$$
More generally, if $\phi$ has free variables amongst $x_1, \dots, x_n$ and $v,w$ are valuations in $\A$ with $v(x_i) = w(x_i)$ for $i = 1, \dots,n$, then
    \[ v[\phi] = T \Leftrightarrow w[\phi]=T. \]
    (Allow $n=0$ for the case with no free variables.)
\end{theorem}
\begin{proof}
Note that the first statement follows from the generalization.
If $\phi$ has no free variables, then, for any valuations $v,w$ in $\A$, they agree on the free variables of $\phi$.

Proving the generalization by induction on the number of connectives and quantifiers in $\phi$.
\begin{itemize}
    \item[Base case:] $\phi$ is atomic $R(t_1,\dots,t_m)$ for terms $t_j$. The $t_j$ only involve variables amongst $x_1,\dots,x_n$. As $v,w$ agree on these variables, they agree on $t_j$, i.e. $v(t_j) = w(t_j)$.
    So $v[R(t_1,\dots,t_m)] = T$ iff
    \[ \overline{R}(v(t_1),\dots,v(t_m)) \] which is equivalent to 
    \[ w[R(t_1,\dots,t_m)] = T. \]
    \item[induction step:] $\phi$ is $(\lnot \psi), (\chi \rightarrow \psi)$ or $(\forall x_i) \psi$.
    The first two cases are left as exercise.
    Suppose $\phi$ is $(\forall x_i) \psi$. Suppose $v[\phi] = F$.
    Then there is a valuation $v`$ that is $x_l$-equivalent to $v$ with $v`[\phi] = F$.
    The free variables on $\psi$ are amongst $x_1,\dots,x_n,x_i$. Let $w`$ be the valuation $x_i$-equivalent to $w$ with $w`(x_i) = v`(x_i)$.
    Then $v`,w`$ agree on the free variables on $\psi$. By the induction hypothesis
        \[ v`[\psi] = w`[\psi] \text{ so } w`[\psi] = F. \]
    As $w`$ is $x_i$-equivalent to $w$ we obtain $w[(\forall x_i)\psi] = F$.
\end{itemize}
\end{proof}

\begin{definition}
 Let $\phi$ be an $\LL$-formula, $x_i$ a variable, $t$ an $\LL$-term, then we say \emph{$t$ is free for $x_i$ in $\phi$}, if there is no variable $x_j$ in $t$ such that $x_i$ has a free occurrence within the scope of a quantifier $(\forall x_j)$ in $\phi$. 
\end{definition}

\begin{theorem}
Suppose $\phi(x_1)$ is an $\LL$-formula (possibly with other free variables). Let $t$ be a term free for $x_1$ in $\phi$. Then 
    \[ \vDash ((\forall x_1)\phi(x_1) \rightarrow \phi(t)). \]
In particular, if $\A$ is an $\LL$-structure with $\A \vDash (\forall x_1)\phi(x_1)$ then $\A \vDash \phi(t)$.
\end{theorem}

\begin{lemma}
With this notation, suppose $v$ is a valuation in $\A$. Let $w$ be a valuation in $\A$ with is $x_1$ equivalent to $v$, with $w(x_1) = v(t)$. Then 
    \[ w[\phi(x_1)] = T \Leftrightarrow v[\phi(t)] = T \]
\end{lemma}

\begin{proof}
The proof is posted on blackboard (omitted here) and works via induction on the connectives and quantifiers.
\end{proof}

\begin{proof}[Proof of theorem]
Suppose $v$ is a valuation with $v[\phi(t)] = F$.
Claim: $v[(\forall x_1) \phi(x_1)] = F$.
To show this claim, take $w$ to be a $x_1$-equivalent valuation to $v$. such that $w(x_1) = v(t)$.
Then by the lemma above 
    \[ w[\phi(x_1)] = F \text{ implies } v[(\forall x_1) \phi(x_1)] = F \]
Thus the implication is shown.
\end{proof}

\subsection{ The formal system $K_{\LL}$ }

\begin{definition}
 Suppose $\LL$ is a first order language. The \emph{formal system $K_\LL$} has as
 \begin{enumerate}
     \item \textbf{formulas}: the $\LL$-formulas
     \item \textbf{axioms}: For $\phi,\psi,\chi$ $\LL$-formulas we have \begin{itemize}
          \item[A1] $(\phi \rightarrow (\psi \rightarrow \phi))$
        \item[A2] $((\phi \rightarrow (\psi \rightarrow \chi)) \rightarrow ((\phi \rightarrow \psi) \rightarrow (\phi \rightarrow \chi)))$
        \item[A3]: $(((\lnot \psi) \rightarrow ( \lnot \phi)) \rightarrow (\phi \rightarrow \psi))$
        \item[K1]: $(\forall x_i) \phi(x_i) \rightarrow \phi(t)$, where $t$ is a term free for $x_i$ in $\phi$.
        \item[K2]: $((\forall x_i)(\phi \rightarrow \psi) \rightarrow (\phi \rightarrow \forall x_i \psi))$ if $x_i$ is not free in $\phi$. 
     \end{itemize}
     
     \item \textbf{deduction rules}
        \begin{enumerate}
            \item \emph{ Modus Ponens (MP)}: from $\phi,  (\phi \rightarrow \psi)$ deduce $\psi$.
            \item Gen(generalization): From $\phi$ deduce $(\forall x_i)\phi)$.
        \end{enumerate}
     
 \end{enumerate}
 
 A \emph{proof} in $K_\LL$ arises in the same way as a proof in $L$.
 A \emph{theorem} of $K_\LL$ is the last formula in some proof.
 Write $\vdash_\LL \phi$ for "$\phi$ is a theorem in $k_\LL$".
 
\end{definition}

\begin{remark}
Sometimes we omit the $K_\LL$ and write $\vdash \phi$.
\end{remark}

\begin{definition}
 Suppose $\Sigma$ is a set of $\LL$-formulas and $\psi$ an $\LL$-formula. A \emph{deduction from $\Sigma$} is a finite sequence of formulas, ending with $\psi$, each of which is one of:
 \begin{enumerate}
     \item an axiom
     \item a formula in $\Sigma$
     \item obtained fro earlier formulas in the deduction using the deduction rules, with the only restriction, that when gen is applied it does not include a variable occurring freely in $\Sigma$.
     Write $\Sigma \vdash \phi$ if there is a deduction of $\phi$ fro $\Sigma$.
 \end{enumerate}
\end{definition}

\begin{remark}
\begin{enumerate}
    If $\Sigma$ consists of closed formulas we do not need to worry about the restriction on Generalization. 
\end{enumerate}
\end{remark}

\begin{theorem}
Suppose $\phi$ is an $\LL$-formula which is a substitution instance of a tautology in propositional logic. Then $\vdash_{K_\LL} \phi$.
\end{theorem}

\begin{example}
$\vdash_{K_\LL} (\lnot \lnot\phi \rightarrow \phi)$ is such a case, etc.
\end{example}

\begin{proof}
There is a tautology $\chi$ with propositional variables $p_1, \dots, p_n$ and $\LL$-formulas $\psi_1, \dots, \psi_n$ such that $\phi$ is obtained from $\chi$ by substituting $\psi_i$ for $p_i$ ($i \leq n$).
By completeness of propositional logic (\ref{Th:completenessL}) there is a proof in $L$ of $\chi$:
$\chi_1,\dots,\chi_r$ (each one a propositional formula and $\chi_r = \chi$.
If we substitute $\psi_1,\psi_n$ for $p_1,\dots, p_n$ in all $\chi_j$ we obtain a sequence of $\LL$-formulas $\phi_1,\dots,\phi_r$ which is a proof of $\phi = \phi_r$.
\end{proof}

\begin{theorem}[Soundness]\label{Th:soundness}
If $\vdash_{K_\LL} \phi$ then $\vDash \phi$ (i.e. it is logically valid).
\end{theorem}

\begin{proof}
Like in the proof for L (\ref{Th:soundnessL}) we need to show
\begin{enumerate}
    \item Axioms are logically valid
    \item Deduction rules preserve logical validity
\end{enumerate}

\begin{enumerate}
    \item The axioms A1, A2, A3 are logically valid since they are substitution instances of the propositional tautologies, which are logically valid themselves.\\
    K1 is logically valid by an earlier result.\\
    K2: Suppose we have a valuation $v$ such that 
        \[ v[(\phi \rightarrow (\forall x_i)\psi)] = F \]
    implying $v[\phi] = T$ and $v[(\forall x_i)\psi)] = F$.
    So there is a valuation $v`$ $x_i$ equivalent to $v$ with $v`[\psi] = F$. Since $v$ and $v`$ agree on all variables free in $\phi$ an earlier result tells us 
    \[ v[\phi] = v`[\phi] = T \]
    \[ v`[(\phi \rightarrow \psi)] = F. \]
    Thus $v[(\forall x_i)(\phi \rightarrow \psi)] = F$ and
    $v[K2] = T$.
    \item deduction rules are left as exercise.
\end{enumerate}
\end{proof}
\begin{exercise}
    Suppose $\Sigma \vdash \psi$, then for every valuation $v$ with $v[\sigma] = T$ for all $\sigma \in \Sigma$ we have $v[\psi] = T$.
\end{exercise}

\begin{corollary}
 There is no $\LL$-formula $\phi$ with $\vdash_{K_\LL} \phi$ and $\vdash_{K_\LL} (\lnot \phi)$.
\end{corollary}

\begin{theorem}[Deduction Theorem]\label{Th:deduction}
Suppose $\LL$ is a first order language. $\Sigma$ a set of $\LL$-formulas and $\phi,\psi$ $\LL$-formulas. Then $\Sigma \cup \{ \phi \} \vdash \psi$ implies $\Sigma \vdash (\phi \rightarrow \psi$.
\end{theorem}

\begin{proof}
Follows from proof of the deduction Theorem for $L$ (\ref{Th:deductionL}) by induction on the length of the deduction.

\begin{enumerate}
    \item[Base case:] One line deduction Argue exactly as in (\ref{Th:deductionL})
    \item[inductive step:] Suppose $\psi$ follows from earlier formulas in the deduction by MP or Gen.
        \begin{itemize}
            \item[MP] Exactly as in (\ref{Th:deductionL})
            \item[Gen] Suppose $\psi$ is obtained using Gen, then $\psi = (\forall x_i) \theta$ and $\Sigma \cup \{ \phi \} \vdash \theta$ and $x_i$ is not free in any formula in $\Sigma \cup \{ \phi \}$.
            By induction we have:
            \[ \Sigma \vdash (\phi \rightarrow \theta) \]
            and by K2 $\Sigma \vdash (\forall x_i(\phi \rightarrow \theta) \rightarrow (\phi \rightarrow \forall x_i \theta)).$
            By Gen $\Sigma \vdash \forall x_i (\phi \rightarrow \theta)$ and $x_i$ is not free  in any formula in $\Sigma$.
            So by MP we get $\Sigma \vdash (\phi \rightarrow (\forall x_i) \theta)$. 
        \end{itemize}
\end{enumerate}
\end{proof}

\subsection{Goedel completeness Theorem}

\begin{definition}
 A set $\Sigma$ of $\LL$-formulas is \emph{consistent} if there is no $\LL$-formula $\phi$ with
    \[ \Sigma \vdash_{K_\LL} \phi \text{ and }  \Sigma \vdash_{K_\LL} (\lnot \phi). \]
    
    By Soundness (or \ref{Th:soundness}) $\emptyset$ is consistent.
\end{definition}

\begin{remark}
If $\Sigma$ is inconsistent then $\Sigma \vdash \chi$ for any $\LL$-formula $\chi$.
\end{remark}

We want to show, that if $\Sigma$ is a consistent set of closed $\LL$-formulas then there is an $\LL$-structure $\A$ with $\A \vDash \sigma$ for all $\sigma \in \Sigma$. From there the completeness Theorem will follow.

\begin{remark}
Simplification: We are going to assume, that $\LL$ is countable. I.e. The variables, constants, relations and functions are all just countably many. So we can enumerate all the $\LL$-formulas by the natural numbers. In particular, we can enumerate the closed $\LL$-formulas as
    \[ \psi_0, \psi_1, \psi_2, \dots \quad. \]
\end{remark}

\begin{proposition}
Suppose $\Sigma$ is a (consistent) set of closed $\LL$-formulas and $\phi$ is a closed $\LL$-formula
\begin{enumerate}
    \item If $\Sigma \not \vdash \phi$ then $\Sigma \cup \{\lnot \phi \}$ is consistent. 
    \item There is a consistent set $\Sigma^* \supseteq \Sigma$ of closed $\LL$-formulas such that, for every closed $\LL$-formula $\psi$ either
        \[ \Sigma^* \vdash \psi \text{ or } \Sigma^* \vdash (\lnot \psi) \]
\end{enumerate}
\end{proposition}

\begin{proof}
Similar to the proofs before the completeness Theorem in $L$ (\ref{Th:completenessL}.
\end{proof}

\begin{theorem}\label{Th:structure_compl}
Suppose that $\Sigma$ is a consistent set of closed $\LL$-formulas. Then there is a countable $\LL$-structure $\A$ with $\A \vDash \Sigma$ (meaning that $\A \vDash \sigma$ for every $\sigma \in \Sigma$.
\end{theorem}

\begin{proof}
Hard part, will come later.
\end{proof}

\begin{theorem}\label{Th:inverseSoundness}
Let $\Sigma$ be a set of closed $\LL$-formulas and $\phi$ a closed $\LL$-formula. If every model of $\Sigma$ is a model of $\phi$, then $\Sigma \vdash \phi$. [Where \emph{being a model of $\Sigma$ implies being a model of $\phi$} means that if $\A \vDash \sigma$ for all $\sigma \in \Sigma$ then $\A \vDash \phi$.]
\end{theorem}

\begin{remark}
This is the opposite direction to Soundness (\ref{Th:soundness}).
\end{remark}

\begin{proof}
We may assume, that $\Sigma$ is consistent, since otherwise everything is a consequence. of $\Sigma$.
By assumption there is no model of $\Sigma \cup \{(\lnot \phi) \}$. So by \ref{Th:structure_compl}, $\Sigma \cup \{ (\lnot \phi) \}$ is inconsistent. So by the first part of the above proposition, $\Sigma \vdash \phi$.
\end{proof}

\begin{theorem}[Godel Completeness Theorem for $K_{\LL}$]
If $\phi$ is an $\LL$-formula with $\vDash \phi$, then $\phi$ is a theorem of $K_{\LL}$, i.e. $\vdash_{K_\LL}$.
\end{theorem}

\begin{proof}
If $\phi$ is closed, this follows from (\ref{Th:inverseSoundness} with $\Sigma = \emptyset$.
Suppose $\phi$ has free variables amongst $x_1,\dots,x_n$ and consider the closed formula $\psi$ 
    \[ (\forall x_1)\dots(\forall x_n) \phi. \]
As $\vDash \phi$ we obtain $\vDash \psi$.
So, by the closed case it follows that $\vdash \psi$. i.e. 
    \[ \vdash (\forall x_1)\dots(\forall x_n) \phi.\]
If $\theta$ is any formula then $\vdash ((\forall x_i)\theta \rightarrow \theta)$.
So with Modus Ponens (applied n times) we obtain $\vdash_{K_\LL} \phi$.
\end{proof}

\begin{corollary}[Compactness Theorem]\label{Th:Compactness}
Suppose $\Sigma$ is a set of closed $\LL$-formulas and every finite subset of $\Sigma$ has a model. Then $\Sigma$ has a model.
\end{corollary}

\begin{proof}
Suppose $\Sigma$ has no model, then by \ref{Th:structure_compl} $\Sigma$ is inconsistent, thus there is a formula $\phi$ with $\Sigma \vdash \phi$ and $\Sigma \vdash (\lnot \phi)$.
Deductions only involve finitely many formulas in $\Sigma$. So there is a finite subset $\Sigma_0 \subseteq \Sigma$ with $\Sigma_0 \vdash \phi$ and $\Sigma_0 \vdash (\lnot \phi)$. But then $\Sigma_0$ is a finite subset of $\Sigma$ having no model -- contradiction.
\end{proof}




\end{document}